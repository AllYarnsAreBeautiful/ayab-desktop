<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ayab-desktop: AYAB - All Yarns Are Beautiful</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ayab_logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ayab-desktop
   </div>
   <div id="projectbrief">AYAB desktop software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">AYAB - All Yarns Are Beautiful </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is the GUI interface for AYAB.</p>
<p>For information on how to install the release version of the software, see <a href="http://manual.ayab-knitting.com">http://manual.ayab-knitting.com</a></p>
<h1><a class="anchor" id="autotoc_md30"></a>
Running from Source &amp; Development</h1>
<p>The AYAB desktop software runs using Python 3.11. This is not the current version of Python, so it is recommended to install the software to a virtual environment. Miniconda provides a virtual environment that is platform-independent and easy to use: download the lastest version from <a href="https://docs.conda.io/en/latest/miniconda.html">https://docs.conda.io/en/latest/miniconda.html</a> and follow the installation instructions for your operating system.</p>
<p>The Python module dependencies can be found in <em>requirements.txt</em>.</p>
<p>This repository uses <a href="https://pre-commit.com/">pre-commit</a> hooks. After cloning the repo and installing the requirements, you should run <code>pre-commit install</code> to set up the git hook scripts.</p>
<h2><a class="anchor" id="autotoc_md31"></a>
Linux</h2>
<p>For flashing the firmware, avrdude has to be available on your system. To be able to work on GUI elements and translation files, the Qt Dev tools are needed also.</p>
<h3><a class="anchor" id="autotoc_md32"></a>
Debian/Ubuntu</h3>
<pre class="fragment">sudo apt-get install python3-pip python3-dev python3-virtualenv python3-gi
sudo apt-get install libasound2-dev avrdude qt6-tools-dev-tools
</pre> <h3><a class="anchor" id="autotoc_md33"></a>
For openSUSE</h3>
<pre class="fragment">sudo zypper install python3-pip python3-virtualenv python3-gi
sudo zypper install libasound avrdude qt6-tools
</pre> <h3><a class="anchor" id="autotoc_md34"></a>
All Distributions</h3>
<p>To be able to communicate with your Arduino, it might be necessary to add the rights for USB communication by adding your user to some groups. </p><pre class="fragment">sudo usermod -aG tty [userName]
sudo usermod -aG dialout [userName]
</pre><p> To install the development version you can checkout the git repository. </p><pre class="fragment">git clone https://github.com/AllYarnsAreBeautiful/ayab-desktop
cd ayab-desktop
</pre><p> Create a virtual environment for AYAB: </p><pre class="fragment">conda create --name ayab -c conda-forge python=3.8 pip
</pre><p> Now activate the virtual environment. The command prompt should now display <code>(ayab)</code> at the beginning of each line. </p><pre class="fragment">conda activate ayab
</pre><p> Install the remaining prerequisites. </p><pre class="fragment">python -m pip install --upgrade pip
pip install --upgrade setuptools
pip install --ignore-installed -r requirements.txt
bash setup-environment.ps1
</pre><p> Now start AYAB with </p><pre class="fragment">fbs run
</pre> <h2><a class="anchor" id="autotoc_md35"></a>
Windows</h2>
<p>Run Anaconda Powershell as administrator and install git. </p><pre class="fragment">conda install git
</pre><p> Now you can download the git repository with: </p><pre class="fragment">git clone https://github.com/AllYarnsAreBeautiful/ayab-desktop
cd ayab-desktop
</pre><p> Next, create a virtual environment for AYAB: </p><pre class="fragment">conda create --name ayab -c conda-forge python=3.8 pip
</pre><p> Activate the virtual environment. The command prompt should now display <code>(ayab)</code> at the beginning of each line. </p><pre class="fragment">conda activate ayab
</pre><p> Install the prerequisite Python modules. </p><pre class="fragment">python -m pip install --upgrade pip
pip install --upgrade setuptools
pip install --ignore-installed -r requirements.txt
</pre><p> To be able to work on GUI elements and translation files, the Qt Dev tools are needed. Navigate to <a href="https://www.qt.io/download">https://www.qt.io/download</a> in a web browser and follow the installation instructions. From the available options, select "Custom install" and then "Qt 6.6.1". Then convert the PySide6 <code>.ui</code> files and generate the translation files: </p><pre class="fragment">.\setup-environment.ps1
</pre><p> Now start AYAB with: </p><pre class="fragment">fbs run
</pre> <h2><a class="anchor" id="autotoc_md36"></a>
macOS</h2>
<p>You can install Git using Homebrew: </p><pre class="fragment">brew install git
</pre><p> You will also need the Xcode command line tools: </p><pre class="fragment">xcode-select --install
</pre><p> Next download the git repository: </p><pre class="fragment">git clone https://github.com/AllYarnsAreBeautiful/ayab-desktop
cd ayab-desktop
</pre><p> Install python from <a href="https://www.python.org/ftp/python/3.11.8/python-3.11.8-macos11.pkg">the official universal2 installer</a>. (Conda does not produce universal binaries)</p>
<p>Create a virtual environment for AYAB: </p><pre class="fragment">python3 -m venv ayab 
</pre><p> Now activate the virtual environment. The command prompt should now display <code>(ayab)</code> at the beginning of each line. </p><pre class="fragment">source ayab/bin/activate
</pre><p> Then install the remaining prerequisites with: </p><pre class="fragment">python3 -m pip install --upgrade pip
pip install --upgrade setuptools
pip install -r requirements.txt
</pre><p> To solve pip SSL:TLSV1_ALERT_PROTOCOL_VERSION problem: </p><pre class="fragment">curl https://bootstrap.pypa.io/get-pip.py | python
</pre><p> To be able to work on GUI elements and translation files, the Qt Dev tools are needed also: </p><pre class="fragment">https://download.qt.io/archive/qt/5.12/5.12.12/qt-opensource-mac-x64-5.12.12.dmg
</pre><p> Finally, convert the PySide6 <code>.ui</code> files and generate the translation files: </p><pre class="fragment">./setup-environment.ps1
</pre><p> If you get errors about missing <code>lrelease</code>, you can skip this if you do not need the translation files. To do so, comment out lines [23:26] of <code>setup-environment.ps1</code>.</p>
<p>Now start AYAB with </p><pre class="fragment">fbs run
</pre> <h1><a class="anchor" id="autotoc_md37"></a>
CI/CD on GitHub</h1>
<h2><a class="anchor" id="autotoc_md38"></a>
Triggering a new build</h2>
<p>A new build is triggered when a new tag is created, either starting with</p>
<ul>
<li>v (i.e. v1.0.0), or</li>
<li>test (i.e. test230517)</li>
</ul>
<p>Convention for the test-tag is to suffix the current date in the YYMMdd format. If there is already an existing test build for a single day, attach a letter. The test tags and releases will be manually removed from time for a better overview.</p>
<p>The tag can be pushed from your local environment, or via the <a href="https://github.com/AllYarnsAreBeautiful/ayab-desktop/releases/new">"Draft a new Release"</a> button on the GitHub website.</p>
<h2><a class="anchor" id="autotoc_md39"></a>
Choosing the firmware release to be bundled with the build</h2>
<p>The CI automatically downloads a given firmware release from the <a href="https://github.com/AllYarnsAreBeautiful/ayab-firmware">ayab-firmware repo</a> and packs it into the Desktop release. The name of the firmware release is chosen in <a href="https://github.com/AllYarnsAreBeautiful/ayab-desktop/blob/1.0.0-dev/src/main/resources/base/ayab/firmware/manifest.txt">this manifest file</a> in the ayab-desktop repo.</p>
<p>Whenever building from source, you should ensure that the firmware is available as a compiled hex file is available at <code>main/resources/base/ayab/firmware/firmware.hex</code>. You can either compile the firmware and upload it through other means (e.g. VSCode with PlatformIO), or compile and then drop it into the right path in the desktop directory, making it available for the flash through AYAB desktop. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
